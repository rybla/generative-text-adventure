{"traceId":"d056892dedfb4d75d93fff8ab5d2b6ae","spans":{"891b52e5ec89b20b":{"spanId":"891b52e5ec89b20b","traceId":"d056892dedfb4d75d93fff8ab5d2b6ae","parentSpanId":"b90895149b1fb52e","startTime":1751305008794,"endTime":1751305008876.3474,"attributes":{"genkit:type":"util","genkit:name":"generate","genkit:path":"/{test_structured_output_union,t:flow}/{generate,t:util}","genkit:input":"{\"model\":\"googleai/gemini-2.5-flash\",\"messages\":[{\"role\":\"user\",\"content\":[{\"text\":\"Make some random choices\"}]}],\"config\":{},\"output\":{\"schema\":{\"_def\":{\"unknownKeys\":\"strip\",\"catchall\":{\"_def\":{\"typeName\":\"ZodNever\"},\"~standard\":{\"version\":1,\"vendor\":\"zod\"}},\"typeName\":\"ZodObject\"},\"~standard\":{\"version\":1,\"vendor\":\"zod\"},\"_cached\":null},\"format\":\"json\",\"jsonSchema\":{\"type\":\"object\",\"properties\":{\"choices\":{\"type\":\"array\",\"items\":{\"anyOf\":[{\"type\":\"object\",\"properties\":{\"type\":{\"type\":\"string\",\"const\":\"cooperate\"},\"description\":{\"type\":\"string\"}},\"required\":[\"type\",\"description\"],\"additionalProperties\":true},{\"type\":\"object\",\"properties\":{\"type\":{\"type\":\"string\",\"const\":\"defect\"},\"description\":{\"type\":\"string\"}},\"required\":[\"type\",\"description\"],\"additionalProperties\":true}]}}},\"required\":[\"choices\"],\"additionalProperties\":true,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}}}","genkit:state":"error"},"displayName":"generate","links":[],"instrumentationLibrary":{"name":"genkit-tracer","version":"v1"},"spanKind":"INTERNAL","sameProcessAsParentSpan":{"value":true},"status":{"code":2,"message":"[GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent: [400 Bad Request] Invalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\nInvalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field. [{\"@type\":\"type.googleapis.com/google.rpc.BadRequest\",\"fieldViolations\":[{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\"},{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field.\"}]}]"},"timeEvents":{"timeEvent":[{"time":1751305008876.28,"annotation":{"attributes":{"exception.type":"Error","exception.message":"[GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent: [400 Bad Request] Invalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\nInvalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field. [{\"@type\":\"type.googleapis.com/google.rpc.BadRequest\",\"fieldViolations\":[{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\"},{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field.\"}]}]","exception.stacktrace":"Error: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent: [400 Bad Request] Invalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\nInvalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field. [{\"@type\":\"type.googleapis.com/google.rpc.BadRequest\",\"fieldViolations\":[{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\"},{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field.\"}]}]\n    at new GoogleGenerativeAIError (/Users/henry/Documents/generative-text-adventure/node_modules/@google/generative-ai/dist/index.js:250:9)\n    at new GoogleGenerativeAIFetchError (/Users/henry/Documents/generative-text-adventure/node_modules/@google/generative-ai/dist/index.js:271:9)\n    at handleResponseNotOk (/Users/henry/Documents/generative-text-adventure/node_modules/@google/generative-ai/dist/index.js:434:15)\n    at processTicksAndRejections (native:7:39)"},"description":"exception"}}]}},"d2bce186eb010c9c":{"spanId":"d2bce186eb010c9c","traceId":"d056892dedfb4d75d93fff8ab5d2b6ae","parentSpanId":"891b52e5ec89b20b","startTime":1751305008808,"endTime":1751305008876.382,"attributes":{"genkit:type":"action","genkit:metadata:subtype":"model","genkit:name":"googleai/gemini-2.5-flash","genkit:path":"/{test_structured_output_union,t:flow}/{generate,t:util}/{googleai/gemini-2.5-flash,t:action,s:model}","genkit:input":"{\"messages\":[{\"role\":\"user\",\"content\":[{\"text\":\"Make some random choices\"}]}],\"config\":{},\"tools\":[],\"output\":{\"constrained\":true,\"contentType\":\"application/json\",\"format\":\"json\",\"schema\":{\"type\":\"object\",\"properties\":{\"choices\":{\"type\":\"array\",\"items\":{\"anyOf\":[{\"type\":\"object\",\"properties\":{\"type\":{\"type\":\"string\",\"const\":\"cooperate\"},\"description\":{\"type\":\"string\"}},\"required\":[\"type\",\"description\"],\"additionalProperties\":true},{\"type\":\"object\",\"properties\":{\"type\":{\"type\":\"string\",\"const\":\"defect\"},\"description\":{\"type\":\"string\"}},\"required\":[\"type\",\"description\"],\"additionalProperties\":true}]}}},\"required\":[\"choices\"],\"additionalProperties\":true,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}}}","genkit:state":"error"},"displayName":"googleai/gemini-2.5-flash","links":[],"instrumentationLibrary":{"name":"genkit-tracer","version":"v1"},"spanKind":"INTERNAL","sameProcessAsParentSpan":{"value":true},"status":{"code":2,"message":"[GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent: [400 Bad Request] Invalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\nInvalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field. [{\"@type\":\"type.googleapis.com/google.rpc.BadRequest\",\"fieldViolations\":[{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\"},{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field.\"}]}]"},"timeEvents":{"timeEvent":[{"time":1751305008876.1985,"annotation":{"attributes":{"exception.type":"Error","exception.message":"[GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent: [400 Bad Request] Invalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\nInvalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field. [{\"@type\":\"type.googleapis.com/google.rpc.BadRequest\",\"fieldViolations\":[{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\"},{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field.\"}]}]","exception.stacktrace":"Error: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent: [400 Bad Request] Invalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\nInvalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field. [{\"@type\":\"type.googleapis.com/google.rpc.BadRequest\",\"fieldViolations\":[{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\"},{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field.\"}]}]\n    at new GoogleGenerativeAIError (/Users/henry/Documents/generative-text-adventure/node_modules/@google/generative-ai/dist/index.js:250:9)\n    at new GoogleGenerativeAIFetchError (/Users/henry/Documents/generative-text-adventure/node_modules/@google/generative-ai/dist/index.js:271:9)\n    at handleResponseNotOk (/Users/henry/Documents/generative-text-adventure/node_modules/@google/generative-ai/dist/index.js:434:15)\n    at processTicksAndRejections (native:7:39)"},"description":"exception"}}]}},"b90895149b1fb52e":{"spanId":"b90895149b1fb52e","traceId":"d056892dedfb4d75d93fff8ab5d2b6ae","startTime":1751305008792,"endTime":1751305008876.7424,"attributes":{"genkit:type":"action","genkit:metadata:subtype":"flow","genkit:name":"test_structured_output_union","genkit:isRoot":true,"genkit:path":"/{test_structured_output_union,t:flow}","genkit:metadata:context":"{}","genkit:input":"{\"prompt\":\"Make some random choices\"}","genkit:state":"error"},"displayName":"test_structured_output_union","links":[],"instrumentationLibrary":{"name":"genkit-tracer","version":"v1"},"spanKind":"INTERNAL","sameProcessAsParentSpan":{"value":true},"status":{"code":2,"message":"[GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent: [400 Bad Request] Invalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\nInvalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field. [{\"@type\":\"type.googleapis.com/google.rpc.BadRequest\",\"fieldViolations\":[{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\"},{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field.\"}]}]"},"timeEvents":{"timeEvent":[{"time":1751305008876.712,"annotation":{"attributes":{"exception.type":"Error","exception.message":"[GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent: [400 Bad Request] Invalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\nInvalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field. [{\"@type\":\"type.googleapis.com/google.rpc.BadRequest\",\"fieldViolations\":[{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\"},{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field.\"}]}]","exception.stacktrace":"Error: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent: [400 Bad Request] Invalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\nInvalid JSON payload received. Unknown name \"const\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field. [{\"@type\":\"type.googleapis.com/google.rpc.BadRequest\",\"fieldViolations\":[{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[0].properties[0].value': Cannot find field.\"},{\"field\":\"generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value\",\"description\":\"Invalid JSON payload received. Unknown name \\\"const\\\" at 'generation_config.response_schema.properties[0].value.items.any_of[1].properties[0].value': Cannot find field.\"}]}]\n    at new GoogleGenerativeAIError (/Users/henry/Documents/generative-text-adventure/node_modules/@google/generative-ai/dist/index.js:250:9)\n    at new GoogleGenerativeAIFetchError (/Users/henry/Documents/generative-text-adventure/node_modules/@google/generative-ai/dist/index.js:271:9)\n    at handleResponseNotOk (/Users/henry/Documents/generative-text-adventure/node_modules/@google/generative-ai/dist/index.js:434:15)\n    at processTicksAndRejections (native:7:39)"},"description":"exception"}}]}}},"displayName":"test_structured_output_union","startTime":1751305008792,"endTime":1751305008876.7424}